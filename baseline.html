
<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="description" content="EE 230, Electronics" />

		
		<title>EE 230 :  Topics</title>		

		 <div id='d1' style="position:absolute; top:500px; left:1000px; z-index:1; border-width:1px">  
			  	<canvas id="nonCanvas" width="300" height="100" style="position:absolute top:500px left:600px border:1px solid #d3d3d3;">
		Your browser does not support the HTML5 canvas tag.</canvas>
		</div>
	</head>

	<style> /* set the CSS */

body { font: 12px Arial;}

/*path { 
    stroke: steelblue;
    stroke-width: 2;
    fill: none;
}*/

.axis path,
.axis line {
    fill: none;
    stroke: grey;
    stroke-width: 1;
    shape-rendering: crispEdges;
}

</style>

	<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.3.3/d3.min.js" type="text/javascript"></script>

	<script Language = "JavaScript">
	function noninverting(obj) {

		Ra = parseFloat(obj.Ra.value)
		Rb = parseFloat(obj.Rb.value)
		VREF = parseFloat(obj.VREF.value)
		VLP = parseFloat(obj.VLP.value)
		VLM = parseFloat(obj.VLM.value)

		VTL = VREF * (1 + Ra / Rb) - Ra / Rb * VLP
		VTH = VREF * (1 + Ra / Rb) - Ra / Rb * VLM
		hyst = VTH - VTL

		obj.VTL.value = VTL
		obj.VTH.value = VTH
		obj.hyst.value = hyst



		var coordinates = 
			[{ "x1": VTL-1, "x2": VTL-1, "y": VLM},
			{ "x1": VTL, "x2": VTH, "y": VLM},
			{ "x1": VTL, "x2": VTH, "y": VLP},
			{ "x1": VTH+1, "x2": VTH+1, "y": VLP}]

		var data = coordinates.slice()
		var x1Data = function(d) {return d.x1}
		var x2Data = function(d) {return d.x2}
		var yData = function(d) {return d.y}

		var windowX = 500
		var windowY = 400

		// Set the dimensions of the canvas / graph
		var margin = {top: 30, right: 20, bottom: 30, left: 50},
		    width = 600 - margin.left - margin.right,
		    height = 270 - margin.top - margin.bottom;


		// Set the ranges
		var x = d3.scale.linear().range([0, width]);
		var y = d3.scale.linear().range([height, 0]);

		// Define the axes
		var xAxis = d3.svg.axis().scale(x)
		    .orient("bottom").ticks(5);

		var yAxis = d3.svg.axis().scale(y)
		    .orient("left").ticks(5);


		// Define the line
		var valueline = d3.svg.line()
		    .x(function(d) { return x(d.x1); })
		    .y(function(d) { return y(d.y); });

		// Define the second line
		var valueline2 = d3.svg.line()
		    .x(function(d) { return x(d.x2); })
		    .y(function(d) { return y(d.y); });
		    
		// Adds the svg canvas
		var svg = d3.select("body")
		    .append("svg")
		        .attr("width", width + margin.left + margin.right)
		        .attr("height", height + margin.top + margin.bottom)
		    .append("g")
		        .attr("transform", 
		              "translate(" + margin.left + "," + margin.top + ")");

		x.domain([VTL-1, VTH+1]);
    	y.domain([VLM, VLP]);

	    // Add the valueline path.
	    svg.append("path")
	        .attr("class", "line")
	        .attr("d", valueline(coordinates))
	        .attr("stroke-width", 2)
	        .attr("stroke", "blue")
	        .attr("fill", "none")


	    // Add the valueline2 path.
	    svg.append("path")
	        .attr("class", "line")
	        .attr("d", valueline2(coordinates))
	        .attr("stroke-width", 2)
	        .attr("stroke", "red")
	        .attr("fill", "none")  

	    // Add the X Axis
	    svg.append("g")
	        .attr("class", "x axis")
	        .attr("transform", "translate(0," + height + ")")
	        .call(xAxis);

	    // Add the Y Axis
	    svg.append("g")
	        .attr("class", "y axis")
	        .call(yAxis);



		// var graphingFunct1 = d3.svg.line()
		// 	.x(function(d) {return (d.x1*xScale)})
		// 	.y(function(d) {return (d.y*yScale)})
		// 	.interpolate("linear");

		// var graphingFunct2 = d3.svg.line()
		// 	.x(function(d) {return (d.x2*xScale)})
		// 	.y(function(d) {return (d.y*yScale)})
		// 	.interpolate("linear");

		// var svg = d3.select("body").append("svg")
		// 	.attr("width", windowX)
		// 	.attr("height", windowY)

		// var graphProper = svg.append("path")
		// 	.attr("d", graphingFunct1(coordinates))
		// 	.attr("stroke", "blue")
		// 	.attr("stroke-width", 1)
		// 	.attr("fill", "none")

		// svg.append("path")
		// 	.attr("d", graphingFunct2(coordinates))
		// 	.attr("stroke", "red")
		// 	.attr("stroke-width", 1)
		// 	.attr("fill", "none")


		// svg.selectAll("path").data(data).enter()
		// 	.append("path")
		// 	.attr("x", function(d) {return x(x1Data(d))})
		// 	.attr("y", function(d) {return y(yData(d))})
		// 	.attr("fill", "none")
  //           .attr("stroke", "blue")
  //           .attr("stroke-width", 3);
	}

	function inverting(obj) {

	Ra = parseFloat(obj.Ra.value)
	Rb = parseFloat(obj.Rb.value)
	VREF = parseFloat(obj.VREF.value)
	VLP = parseFloat(obj.VLP.value)
	VLM = parseFloat(obj.VLM.value)

	VTL = (VREF + Ra / Rb * VLM) / (1 + Ra / Rb)
	VTH = (VREF + Ra / Rb * VLP) / (1 + Ra / Rb)
	hyst = VTH - VTL

	obj.VTL.value = VTL
	obj.VTH.value = VTH
	obj.hyst.value = hyst

	}
	</script>
	
	<body>



			<h2>Comparator Calculators</h2>	

			<h3>Non-Inverting</h3>

			<img src= "noninverting.png">

			<form name="noninv">
				<table border="0">
					<tr>
						<td>Ra: </td>
						<td><input type=text size = "7" name="Ra">k&#8486</td>
						<td>VTL: </td>
						<td><input type=text size = "7" name="VTL">V</td>
					</tr><tr>
						<td>Rb: </td>
						<td><input type=text size = "7" name="Rb">k&#8486<br></td>
						<td>VTH: </td>
						<td><input type=text size = "7" name="VTH">V</td>
					</tr><tr>
						<td>VREF: </td>
						<td><input type=text size = "7" name="VREF">V</td>
						<td>Hysteresis: </td>
						<td><input type=text size = "7" name="hyst">V</td>
					</tr><tr>
						<td>VL+: </td>
						<td><input type=text size = "7" name="VLP">V</td>
					</tr><tr>
						<td>VL-: </td>
						<td><input type=text size = "7" name="VLM">V</td>
					</tr>
				</table>
			<br><input type="button" value="Calculate" onClick="noninverting(this.form)"><br><br>
			</form>

			<h3>Inverting</h3>

			<img src= "inverting.png">

			<form name="inv">
				<table border="0">
					<tr>
						<td>Ra: </td>
						<td><input type=text size = "7" name="Ra">k&#8486</td>
						<td>VTL: </td>
						<td><input type=text size = "7" name="VTL">V</td>
					</tr><tr>
						<td>Rb: </td>
						<td><input type=text size = "7" name="Rb">k&#8486<br></td>
						<td>VTH: </td>
						<td><input type=text size = "7" name="VTH">V</td>
					</tr><tr>
						<td>VREF: </td>
						<td><input type=text size = "7" name="VREF">V</td>
						<td>Hysteresis: </td>
						<td><input type=text size = "7" name="hyst">V</td>
					</tr><tr>
						<td>VL+: </td>
						<td><input type=text size = "7" name="VLP">V</td>
					</tr><tr>
						<td>VL-: </td>
						<td><input type=text size = "7" name="VLM">V</td>
					</tr>
				</table>
			<br><input type="button" value="Calculate" onClick="inverting(this.form)">
			</form>		

		
											



 
		
	</body>
</html>
